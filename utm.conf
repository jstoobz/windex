# utm.conf — Shared configuration for UTM test harness
#
# All values have sensible defaults. Override by setting env vars before
# running scripts, or edit this file for your setup.
#
# Usage: source this file from any utm-*.sh script
#   source "$(dirname "$0")/utm.conf"

# VM name in UTM (must match exactly)
VM_NAME="${VM_NAME:-Win11-Golden}"

# SSH connection settings
SSH_KEY="${SSH_KEY:-$HOME/.ssh/utm_vm}"
SSH_PORT="${SSH_PORT:-2222}"

# Host-side paths (relative to this repo)
UTM_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
SCRIPTS_DIR="${SCRIPTS_DIR:-$UTM_DIR/scripts}"
RESULTS_DIR="${RESULTS_DIR:-$UTM_DIR/test-results}"

# Guest-side paths (where scripts are deployed inside the Windows VM)
GUEST_DIR="${GUEST_DIR:-C:/provision}"
GUEST_SCRIPTS="$GUEST_DIR/scripts"
GUEST_LIB="$GUEST_SCRIPTS/lib"
GUEST_LOGS="$GUEST_DIR/logs"
GUEST_OUTPUT="$GUEST_DIR/output"

# Timeouts
POLL_INTERVAL="${POLL_INTERVAL:-5}"
MAX_WAIT="${MAX_WAIT:-600}"  # 10 min — disposable Windows boots are slow

# Common SSH options (bypass user config, no host key checking)
SSH_COMMON=(-F /dev/null -i "$SSH_KEY" -o StrictHostKeyChecking=no \
    -o UserKnownHostsFile=/dev/null -o ConnectTimeout=5 -o LogLevel=ERROR)
